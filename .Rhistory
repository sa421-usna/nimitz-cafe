library(readxl)
library(fitdistrplus)
library(dplyr)
library(knitr)
##### Read arrival time data and compute interarrival times #####
# Read arrival times from Excel file
arrival.data <- read_excel('cafe-data.xlsx', range = 'Sheet1!A2:A88', col_names = 'arrival.times')
# Get arrival times as a vector
arrival.times <- arrival.data$arrival.times
# Sort arrival times
arrival.times <- sort(arrival.times)
# Compute interarrival times (seconds)
interarrival.times <- as.numeric(diff(arrival.times))
# Assume that simultaneous arrivals are in fact 1 second apart
interarrival.times[interarrival.times == 0] <- 1
##### Inspect data #####
plotdist(interarrival.times)
# Find maximum likelihood estimator for exponential, gamma, and lognormal distributions
interarrival.fit.exp <- fitdist(interarrival.times, "exp")
summary(interarrival.fit.exp)
interarrival.fit.gamma <- fitdist(interarrival.times, "gamma")
summary(interarrival.fit.gamma)
interarrival.fit.lnorm <- fitdist(interarrival.times, "lnorm")
summary(interarrival.fit.lnorm)
par(mfrow=c(1,2))
denscomp(list(interarrival.fit.exp, interarrival.fit.gamma, interarrival.fit.lnorm),
legendtext = c('exponential', 'gamma', 'lognormal'))
cdfcomp(list(interarrival.fit.exp, interarrival.fit.gamma, interarrival.fit.lnorm),
legendtext = c('exponential', 'gamma', 'lognormal'))
interarrival.gof <- gofstat(list(interarrival.fit.exp, interarrival.fit.gamma, interarrival.fit.lnorm),
fitnames = c('exponential', 'gamma', 'lognormal'))
print(interarrival.gof)
# Read service times from Excel file
cashier.data <- read_excel('cafe-data.xlsx', range = 'Sheet1!E2:E28', col_names = 'cashier.times')
# Get service times as a vector in seconds
cashier.times <- cashier.data$cashier.times
##### Inspect data #####
plotdist(cashier.times)
# Find maximum likelihood estimator for gamma and lognormal distributions
cashier.fit.gamma <- fitdist(cashier.times, "gamma")
summary(cashier.fit.gamma)
cashier.fit.lnorm <- fitdist(cashier.times, "lnorm")
summary(cashier.fit.lnorm)
par(mfrow=c(1,2))
denscomp(list(cashier.fit.gamma, cashier.fit.lnorm), legendtext = c('gamma', 'lognormal'))
cdfcomp(list(cashier.fit.gamma, cashier.fit.lnorm), legendtext = c('gamma', 'lognormal'))
cashier.gof <- gofstat(list(cashier.fit.gamma, cashier.fit.lnorm),
fitnames = c('gamma', 'lognormal'))
print(cashier.gof)
# Read service times from Excel file
service.data <- read_excel('cafe-data.xlsx', range = 'Sheet1!C2:C39', col_names = 'service.times')
# Get service times as a vector in seconds
service.times <- service.data$service.times
##### Inspect data #####
plotdist(service.times)
# Find maximum likelihood estimator for gamma and lognormal distributions
service.fit.gamma <- fitdist(service.times, "gamma")
summary(service.fit.gamma)
service.fit.lnorm <- fitdist(service.times, "lnorm")
summary(service.fit.lnorm)
par(mfrow=c(1,2))
denscomp(list(service.fit.gamma, service.fit.lnorm), legendtext = c('gamma', 'lognormal'))
cdfcomp(list(service.fit.gamma, service.fit.lnorm), legendtext = c('gamma', 'lognormal'))
service.gof <- gofstat(list(service.fit.gamma, service.fit.lnorm),
fitnames = c('gamma', 'lognormal'))
print(service.gof)
# Run simulation for question 1
system("java -jar '/Applications/jaamsim/JaamSim2017-09.jar' 'Nimitz Coffee Bar Simulation Number of Baristas.cfg' -b")
# Read output from simulation
output <- read.table("Nimitz Coffee Bar Simulation Number of Baristas.dat",
sep="\t", skip=2,
col.names=c('number.of.workers', 'run', 'avg.delay'))
output %>%
group_by(number.of.workers) %>%
summarise(mean.avg.delay = mean(avg.delay), ci.range = 2*1.96*sd(avg.delay)/sqrt(n())) %>%
kable(col.names = c('Number of baristas', 'Average delay', 'CI range'))
